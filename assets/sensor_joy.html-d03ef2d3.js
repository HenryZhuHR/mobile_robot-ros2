import{_ as o,r as t,o as c,c as p,a as s,b as n,d as i,e as a}from"./app-691e7cc7.js";const l={},d=a('<h1 id="手柄" tabindex="-1"><a class="header-anchor" href="#手柄" aria-hidden="true">#</a> 手柄</h1><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h2><p>手柄将作为一个传感器 ，发布手柄摇杆量和按键状态消息。</p><p>其「状态分组」为 <code>SystemState::StateGroup::SENSOR</code></p><p>其「组内注册序号」为 <code>SystemState::Sensor::SENSOR_JOY</code></p><h2 id="功能设计" tabindex="-1"><a class="header-anchor" href="#功能设计" aria-hidden="true">#</a> 功能设计</h2><p>检测手柄摇杆量和按键状态，发布消息。</p><ul><li>将手柄摇杆量转化为控制速度发出，话题名称 <code>SystemState.topics.joy_speed</code> ，消息类型 <code>state_interfaces::msg::Speed</code> ，当检测到手柄摇杆量变化时发布。</li><li>(TODO) 话题名称 <code>SystemState::topics::joy_button</code> ，消息类型 <code>state_interfaces::msg::Button</code> ，当检测到手柄按键变化时发布。</li></ul><h2 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件" aria-hidden="true">#</a> 配置文件</h2>',9),r={href:"http://wiki.ros.org/joy",target:"_blank",rel:"noopener noreferrer"},u=s("code",null,"/dev/input/js0",-1),m=s("code",null,"sensor_msgs::Joy",-1),k=a(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>sensor_msgs<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>Joy<span class="token punctuation">(</span>
    header<span class="token operator">=</span>std_msgs<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>Header<span class="token punctuation">(</span>
        stamp<span class="token operator">=</span>builtin_interfaces<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>Time<span class="token punctuation">(</span>
            sec<span class="token operator">=</span><span class="token number">1690353442</span><span class="token punctuation">,</span>
            nanosec<span class="token operator">=</span><span class="token number">770217921</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        frame_id<span class="token operator">=</span><span class="token string">&#39;joy&#39;</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    axes<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token operator">-</span><span class="token number">0.0</span><span class="token punctuation">,</span>   <span class="token comment"># 左摇杆 x 轴   : 左+ 右-</span>
        <span class="token operator">-</span><span class="token number">0.0</span><span class="token punctuation">,</span>   <span class="token comment"># 左摇杆 y 轴   : 上+ 下-</span>
        <span class="token operator">-</span><span class="token number">0.0</span><span class="token punctuation">,</span>   <span class="token comment"># 右摇杆 y 轴   : 上+ 下-</span>
        <span class="token operator">-</span><span class="token number">0.0</span><span class="token punctuation">,</span>   <span class="token comment"># 右摇杆 x 轴   : 左+ 右-</span>
        <span class="token number">0.0</span><span class="token punctuation">,</span>    <span class="token comment"># 左侧方向键 x 轴: 左+ 右-</span>
        <span class="token number">0.0</span>     <span class="token comment"># 左侧方向键 y 轴: 上+ 下-</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    buttons<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  0 右侧按键 1</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  1 右侧按键 2</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  2 右侧按键 3</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  3 右侧按键 4</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  4 左上侧按键 1</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  5 右上侧按键 1</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  6 左上侧按键 2</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  7 右上侧按键 2</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  8 select</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">#  9 start</span>
        <span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment"># 10 左摇杆按键</span>
        <span class="token number">0</span>       <span class="token comment"># 11 右摇杆按键</span>
        <span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是不同手柄读取的摇杆量和按键状态不同，需要对其进行映射，并统一转化为控制速度和按键消息</p><p>映射文件(<code>.json</code>)中需要给出的键值，值为下标(<code>int</code>)：</p><p>axes:</p><ul><li><code>axis_stick_left__LR</code>: 左摇杆，左右，默认左+右-</li><li><code>axis_stick_left__UD</code>: 左摇杆，上下，默认上+下-</li><li><code>axis_stick_right_LR</code>: 右摇杆，左右，默认左+右-</li><li><code>axis_stick_right_UD</code>: 右摇杆，上下，默认上+下-</li><li><code>axis_cross_LR</code>: 方向键，左右，默认左+右-</li><li><code>axis_cross_UD</code>: 方向键，上下，默认上+下-</li><li><code>axis_LT</code>: 左上侧按键 2，默认按下为 -1.0，松开为 1.0</li><li><code>axis_RT</code>: 右上侧按键 2，默认按下为 -1.0，松开为 1.0</li></ul><p>buttons:</p><ul><li><code>A</code>: 右侧按键 1</li><li><code>B</code></li><li><code>X</code></li><li><code>Y</code></li><li><code>LB</code>: 左上侧按键 1</li><li><code>RB</code>: 右上侧按键 1</li><li><code>select</code></li><li><code>start</code></li><li><code>button_stick__left</code>: 左摇杆按键</li><li><code>button_stick_right</code>: 右摇杆按键</li></ul><p>现有的映射文件：</p><ul><li>Microsoft Xbox 360 手柄 : <code>configs/sensors/sensor_joy/key_maps/Microsoft-X-Box-360-pad.json</code></li><li>不知名的有线手柄 : <code>configs/sensors/sensor_joy/key_maps/wire_joy.json</code></li></ul><h2 id="调试命令" tabindex="-1"><a class="header-anchor" href="#调试命令" aria-hidden="true">#</a> 调试命令</h2><ul><li>在 <code>modules/sensors/sensor_joy_py/scripts/joy_test.py</code> 中，可以测试手柄的摇杆量和按键状态，而不依赖于 ROS 节点，目的是为了测试手柄功能是否正常</li><li><code>modules/sensors/sensor_joy_py/scripts/run.sh</code> 启动一个 launch 文件，同时启动 ROS 内置 Joy 节点和传感器节点，可以测试手柄功能是否正常，以及传感器节点是否正常发布消息</li></ul>`,11);function _(v,b){const e=t("ExternalLinkIcon");return c(),p("div",null,[d,s("p",null,[n("ROS 内置了 "),s("a",r,[n("Joy 节点"),i(e)]),n("，实时将 "),u,n(" 的数据转化为 "),m,n(" 消息，其数据结构如下：")]),k])}const y=o(l,[["render",_],["__file","sensor_joy.html.vue"]]);export{y as default};
