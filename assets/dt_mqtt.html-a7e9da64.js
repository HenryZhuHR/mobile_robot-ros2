import{_ as t,r as o,o as p,c as i,a as n,b as s,d as e,e as l}from"./app-691e7cc7.js";const c={},r=n("h1",{id:"mqtt-客户端功能",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#mqtt-客户端功能","aria-hidden":"true"},"#"),s(" MQTT 客户端功能")],-1),u=n("h2",{id:"技术栈",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#技术栈","aria-hidden":"true"},"#"),s(" 技术栈")],-1),d={href:"https://www.emqx.io",target:"_blank",rel:"noopener noreferrer"},v={href:"https://eclipse.dev/paho",target:"_blank",rel:"noopener noreferrer"},k=l(`<h2 id="mqtt-主题设计原则" tabindex="-1"><a class="header-anchor" href="#mqtt-主题设计原则" aria-hidden="true">#</a> MQTT 主题设计原则</h2><ul><li><strong>确保 MQTT 主题级别仅使用小写字母、数字和破折号。</strong> 由于 MQTT 主题区分大小写，设计 MQTT 主题时，一定要使用一组标准的命名约定。因此，客户在创建每个主题级别时，应仅使用小写字母、数字和破折号。客户应避免使用驼峰式大小写和空格等难以调试的字符。</li><li><strong>确保 MQTT 主题级别结构遵循从一般到具体的模式。</strong> 主题架构从左到右，主题级别从一般到具体。</li><li><strong>为 MQTT 主题添加前缀，以区分数据主题与命令主题。</strong> 确保 MQTT 主题在命令和数据消息之间不存在 重叠。通过预留第一个主题级别来表示数据和命令主题，您可以更轻松地使用 IoT 策略创建细粒度权 限，分开监控命令和命令响应的状态与被动遥测命令。</li></ul><h2 id="mqtt-主题" tabindex="-1"><a class="header-anchor" href="#mqtt-主题" aria-hidden="true">#</a> MQTT 主题</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/&lt;message_type&gt;/&lt;device_type&gt;/&lt;application&gt;/&lt;client_id&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>message_type</code>: 消息类型，包括 <code>cmd</code> 和 <code>data</code></li><li><code>device_type</code>: 设备类型</li><li><code>application</code>: 应用名称</li><li><code>client_id</code>: 客户端 ID</li></ul><h3 id="状态数据上报" tabindex="-1"><a class="header-anchor" href="#状态数据上报" aria-hidden="true">#</a> 状态数据上报</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/data/car/state/&lt;client_id&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>数据格式</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mqtt_123456789&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mac&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aa:aa:aa:aa:aa:aa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;car&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-08-22 02:19:14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
            <span class="token property">&quot;z&quot;</span><span class="token operator">:</span> <span class="token number">34</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;norm_location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;z&quot;</span><span class="token operator">:</span> <span class="token number">0.4</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="控制指令下发与响应" tabindex="-1"><a class="header-anchor" href="#控制指令下发与响应" aria-hidden="true">#</a> 控制指令下发与响应</h3><p>控制指令下发</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/cmd/car/control/&lt;client_id&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>控制指令下发时携带一个随机生成的命令编号 <code>id</code> ，用于标识该条指令，以及一个 <code>control</code> 数组，数组中每个元素为一个指令（便于指令的组合），指令包括 <code>action</code> 和 <code>args</code> 两个字段，<code>action</code> 为指令名称，<code>args</code> 为指令参数。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mqttjs_123456789&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-08-22 02:19:14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456789&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;control&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;move&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token number">0.5</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>控制指令响应</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/cmd/car/response/&lt;client_id&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>响应指令中，包含 <code>id</code> 用于与控制指令对应，以区分多条指令，<code>response</code> 数组中每个元素为一个指令的响应的错误码，<code>0</code> 表示成功，其他值表示失败。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mqttjs_123456789&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-08-22 02:19:14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456789&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token number">0</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mqttjs_123456789&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-08-22 02:19:14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456789&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;response&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token number">0</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2>`,20),m={href:"https://www.emqx.com/zh/blog/mqtt-topic-design-for-internet-of-vehicles",target:"_blank",rel:"noopener noreferrer"},q={href:"https://blog.csdn.net/weixin_44788542/article/details/129690265",target:"_blank",rel:"noopener noreferrer"};function b(g,h){const a=o("ExternalLinkIcon");return p(),i("div",null,[r,u,n("ul",null,[n("li",null,[n("a",d,[s("EMQX"),e(a)]),s(": MQTT 服务器")]),n("li",null,[n("a",v,[s("paho.mqtt"),e(a)]),s(": MQTT 客户端")])]),k,n("ul",null,[n("li",null,[n("a",m,[s("车联网 TSP 平台场景中的 MQTT 主题设计"),e(a)])]),n("li",null,[n("a",q,[s("MQTT协议史上最全解析(纯干货分享)"),e(a)])])])])}const x=t(c,[["render",b],["__file","dt_mqtt.html.vue"]]);export{x as default};
